<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Find Speakers - CoveTalks</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/Images/CoveTalks_Vertical.svg">
    
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="/css/main.css">
    
    <!-- Page-specific styles aligned with brand -->

    <!-- PWA Support -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#155487">
    <link rel="apple-touch-icon" href="/Images/icon-192x192.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="CoveTalks">
    <meta name="msapplication-TileImage" content="/Images/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#155487">
    
    <style>
        /* Page Header - Using brand colors */
        .page-header {
            background: linear-gradient(135deg, var(--color-deep) 0%, var(--color-calm) 100%);
            color: white;
            padding: 8rem 0 4rem 0;
            margin-bottom: var(--spacing-xl);
            border-radius: 15px;
            text-align: center;
        }

        .page-header h1 {
            margin-bottom: var(--spacing-sm);
            color: white;
            font-family: 'Brandon Text', var(--font-primary);
            font-weight: 900; /* Brandon Text Black */
            font-size: 2.5rem;
        }

        .page-header p {
            font-size: 1.1rem;
            opacity: 0.95;
            font-family: 'Brandon Text', var(--font-primary);
            font-weight: 400; /* Brandon Text Regular */
        }

        /* Stats Bar - Clean and minimal */
        .stats-bar {
            background: white;
            padding: var(--spacing-lg);
            border-radius: 15px;
            box-shadow: var(--shadow-md);
            margin-bottom: var(--spacing-xl);
            display: flex;
            justify-content: space-around;
            align-items: center;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            color: var(--color-sand);
            font-family: 'Brandon Text', var(--font-primary);
        }

        .stat-label {
            color: var(--color-gray);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }

        /* Search Section - Clean and approachable */
        .search-section {
            background: white;
            padding: var(--spacing-xl);
            border-radius: 15px;
            box-shadow: var(--shadow-md);
            margin-bottom: var(--spacing-xl);
        }

        .search-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            gap: var(--spacing-md);
        }

        .search-title {
            color: var(--color-deep);
            font-size: 1.5rem;
            font-weight: 900;
            font-family: 'Brandon Text', var(--font-primary);
        }

        .view-toggle {
            display: flex;
            background: var(--color-foam);
            border-radius: 25px;
            padding: 0.25rem;
        }

        .view-btn {
            padding: 0.5rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all var(--transition-fast);
            font-weight: 500;
            color: var(--color-gray);
        }

        .view-btn.active {
            background: white;
            box-shadow: var(--shadow-sm);
            color: var(--color-deep);
        }

        /* Search Filters - More approachable */
        .search-filters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .filter-group input,
        .filter-group select {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--color-foam);
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all var(--transition-fast);
            background: var(--color-foam);
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: var(--color-calm);
            background: white;
            box-shadow: 0 0 0 3px rgba(29, 147, 183, 0.1);
        }

        .filter-group input::placeholder {
            color: var(--color-gray-light);
        }

        .search-actions {
            display: flex;
            gap: var(--spacing-md);
            justify-content: center;
        }

        .search-actions .btn {
            min-width: 150px;
        }

        /* Member Grid - Spacious and clean */
        .members-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: var(--spacing-xl);
            margin-bottom: var(--spacing-xl);
        }

        /* Member Card - Redesigned to match brand */
        .member-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow-md);
            transition: all var(--transition-normal);
            cursor: pointer;
            position: relative;
        }

        .member-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
        }

        /* Member Header Section */
        .member-header {
            background: linear-gradient(135deg, var(--color-foam) 0%, white 100%);
            padding: var(--spacing-lg);
            display: flex;
            align-items: center;
            gap: var(--spacing-md);
        }

        .member-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-sand), var(--color-calm));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: 900;
            flex-shrink: 0;
            overflow: hidden;
            border: 3px solid white;
            box-shadow: var(--shadow-sm);
        }

        .member-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .member-basic-info {
            flex: 1;
        }

        .member-name {
            font-size: 1.25rem;
            font-weight: 900;
            color: var(--color-deep);
            margin-bottom: 0.25rem;
            font-family: 'Brandon Text', var(--font-primary);
        }

        .member-type-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            margin-bottom: 0.5rem;
        }

        .badge-speaker {
            background: var(--color-calm);
            color: white;
        }

        .badge-organization {
            background: var(--color-sand);
            color: white;
        }

        .member-location {
            color: var(--color-gray);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        /* Member Body Section */
        .member-body {
            padding: var(--spacing-lg);
        }

        .member-bio {
            color: var(--color-gray);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: var(--spacing-md);
            min-height: 3rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .member-specialties {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
            min-height: 2rem;
        }

        .specialty-tag {
            background: rgba(29, 147, 183, 0.1);
            color: var(--color-calm);
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 500;
            border: 1px solid rgba(29, 147, 183, 0.2);
        }

        .member-rating {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            margin-bottom: var(--spacing-md);
        }

        .stars {
            color: var(--color-sand);
            font-size: 1rem;
        }

        .rating-text {
            color: var(--color-gray);
            font-size: 0.9rem;
        }

        /* Member Footer */
        .member-footer {
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--color-foam);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .contact-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--color-gray);
            font-size: 0.85rem;
        }

        .status-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-success);
        }

        .status-indicator.locked {
            background: var(--color-sand);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--spacing-3xl);
            color: var(--color-gray);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: var(--spacing-md);
            opacity: 0.5;
        }

        .empty-state h3 {
            color: var(--color-deep);
            margin-bottom: var(--spacing-md);
            font-weight: 900;
            font-family: 'Brandon Text', var(--font-primary);
        }

        /* Auth Banner - More inviting */
        .auth-banner {
            background: linear-gradient(135deg, rgba(243, 179, 56, 0.1), rgba(29, 147, 183, 0.1));
            border: 2px solid var(--color-sand);
            border-radius: 15px;
            padding: var(--spacing-xl);
            text-align: center;
            margin-bottom: var(--spacing-xl);
        }

        .auth-banner h3 {
            color: var(--color-deep);
            margin-bottom: var(--spacing-sm);
            font-weight: 900;
            font-family: 'Brandon Text', var(--font-primary);
        }

        .auth-banner p {
            color: var(--color-gray);
            margin-bottom: var(--spacing-lg);
        }

        .auth-banner .btn-group {
            display: flex;
            gap: var(--spacing-md);
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Loading State */
        .loading-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: var(--spacing-3xl);
        }

        /* List View Styles */
        .members-list {
            background: white;
            border-radius: 15px;
            box-shadow: var(--shadow-md);
            overflow: hidden;
            margin-bottom: var(--spacing-xl);
        }

        .list-container {
            overflow-x: auto;
        }

        .members-table {
            width: 100%;
            border-collapse: collapse;
        }

        .members-table th {
            text-align: left;
            padding: var(--spacing-md);
            background: var(--color-foam);
            font-weight: 700;
            color: var(--color-deep);
            font-size: 0.9rem;
            border-bottom: 2px solid white;
            font-family: 'Brandon Text', var(--font-primary);
        }

        .members-table td {
            padding: var(--spacing-md);
            border-bottom: 1px solid var(--color-foam);
            vertical-align: middle;
        }

        .members-table tr:hover {
            background: rgba(243, 179, 56, 0.05);
        }

        .members-table .member-type-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
        }

        /* Fix button alignment in footer */
        .member-footer {
            padding: var(--spacing-md) var(--spacing-lg);
            background: var(--color-foam);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: var(--spacing-md);
        }

        .member-footer .btn {
            white-space: nowrap;
            flex-shrink: 0;
        }

        .contact-status {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--color-gray);
            font-size: 0.85rem;
            flex: 1;
            min-width: 0;
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .members-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
            
            .stats-bar {
                flex-wrap: wrap;
                gap: var(--spacing-lg);
            }
        }

        @media (max-width: 768px) {
            .page-header h1 {
                font-size: 2rem;
            }
            
            .members-grid {
                grid-template-columns: 1fr;
            }
            
            .search-header {
                flex-direction: column;
                align-items: stretch;
            }
            
            .view-toggle {
                justify-content: center;
            }
            
            .stats-bar {
                flex-direction: column;
            }
            
            .stat-item {
                width: 100%;
                padding: var(--spacing-md) 0;
                border-bottom: 1px solid var(--color-foam);
            }
            
            .stat-item:last-child {
                border-bottom: none;
            }
        }

        @media (max-width: 576px) {
            .page-header {
                padding: var(--spacing-xl) 0 var(--spacing-lg) 0;
            }
            
            .page-header h1 {
                font-size: 1.75rem;
            }
            
            .search-filters {
                grid-template-columns: 1fr;
            }
            
            .search-actions {
                flex-direction: column;
            }
            
            .search-actions .btn {
                width: 100%;
            }
            
            .member-header {
                flex-direction: column;
                text-align: center;
            }
            
            .member-avatar {
                margin-bottom: var(--spacing-md);
            }
        }
    </style>
</head>
<body>
    <!-- Header will be auto-injected by header.js -->

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Page Header with Brand Colors -->
            <div class="page-header">
                <h1>Find Your Perfect Speaker</h1>
                <p>Connect with industry professionals ready to share their knowledge</p>
            </div>

            <!-- Stats Bar -->
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-value" id="totalSpeakers">0</div>
                    <div class="stat-label">Speakers</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalOrgs">0</div>
                    <div class="stat-label">Organizations</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="avgRating">0.0</div>
                    <div class="stat-label">Avg Rating</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="newMembers">0</div>
                    <div class="stat-label">New This Month</div>
                </div>
            </div>

            <!-- Auth Banner (shown when not logged in) -->
            <div id="authBanner" class="auth-banner hidden">
                <h3>Join CoveTalks to Connect</h3>
                <p>Create your free account to view contact information and connect with speakers</p>
                <div class="btn-group">
                    <a href="/register.html" class="btn btn-primary">Join CoveTalks</a>
                    <a href="/login.html" class="btn btn-secondary">Sign In</a>
                </div>
            </div>

            <!-- Search Section -->
            <div class="search-section">
                <div class="search-header">
                    <h2 class="search-title">Browse Members</h2>
                    <div class="view-toggle">
                        <button class="view-btn active" onclick="setView('grid')">Grid</button>
                        <button class="view-btn" onclick="setView('list')">List</button>
                    </div>
                </div>

                <div class="search-filters">
                    <div class="filter-group">
                        <input type="text" id="searchTerm" placeholder="🔍 Search by name or expertise...">
                    </div>
                    <div class="filter-group">
                        <select id="typeFilter">
                            <option value="">All Members</option>
                            <option value="Speaker">Speakers Only</option>
                            <option value="Organization">Organizations Only</option>
                        </select>
                    </div>
                    <div class="filter-group">
                        <input type="text" id="locationFilter" placeholder="📍 Location">
                    </div>
                    <div class="filter-group">
                        <select id="specialtyFilter">
                            <option value="">All Topics</option>
                            <option value="Leadership">Leadership</option>
                            <option value="Technology">Technology</option>
                            <option value="Business">Business</option>
                            <option value="Health">Health & Wellness</option>
                            <option value="Education">Education</option>
                            <option value="Innovation">Innovation</option>
                        </select>
                    </div>
                </div>

                <div class="search-actions">
                    <button id="searchBtn" class="btn btn-primary" onclick="performSearch()">
                        Search Members
                    </button>
                    <button class="btn btn-secondary" onclick="clearFilters()">
                        Clear Filters
                    </button>
                </div>
            </div>

            <!-- Results Grid -->
            <div id="membersGrid" class="members-grid">
                <div class="loading-container">
                    <div class="loading">
                        <div class="loading-spinner"></div>
                        Loading members...
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer will be auto-injected by footer.js -->

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/js/config.js"></script>
    <script src="/js/supabase-client.js"></script>
    <script src="/js/components/header.js"></script>
    <script src="/js/components/footer.js"></script>
    
    <!-- Page JavaScript -->
    <script>
        let currentUser = null;
        let isAuthenticated = false;
        let allMembers = [];
        let currentView = 'grid';

        async function initializePage() {
            try {
                await waitForSupabase();
                
                const session = await window.covetalks.checkAuth();
                if (session) {
                    isAuthenticated = true;
                    currentUser = await window.covetalks.getMemberProfile(session.user.id);
                    document.getElementById('authBanner').classList.add('hidden');
                } else {
                    document.getElementById('authBanner').classList.remove('hidden');
                }
                
                await loadMembers();
                
            } catch (error) {
                console.error('Error:', error);
                displaySampleMembers();
            }
        }

        function waitForSupabase() {
            return new Promise((resolve) => {
                let attempts = 0;
                const maxAttempts = 20;
                
                function check() {
                    attempts++;
                    if (window.covetalks?.supabase) {
                        resolve();
                    } else if (attempts < maxAttempts) {
                        setTimeout(check, 250);
                    } else {
                        resolve();
                    }
                }
                check();
            });
        }

        async function loadMembers() {
            try {
                const members = await window.covetalks.searchMembers({});
                allMembers = members || [];
                
                if (allMembers.length === 0) {
                    displaySampleMembers();
                } else {
                    updateStats(allMembers);
                    displayMembers(allMembers);
                }
            } catch (error) {
                console.error('Load error:', error);
                displaySampleMembers();
            }
        }

        function displaySampleMembers() {
            const samples = [
                {
                    id: '1',
                    name: 'Dr. Sarah Johnson',
                    member_type: 'Speaker',
                    location: 'New York, NY',
                    bio: 'Leadership expert and keynote speaker with 15+ years helping Fortune 500 companies transform their culture',
                    specialties: ['Leadership', 'Team Building', 'Culture'],
                    average_rating: 4.8,
                    total_reviews: 42
                },
                {
                    id: '2',
                    name: 'Tech Innovators Conference',
                    member_type: 'Organization',
                    location: 'San Francisco, CA',
                    bio: 'Annual technology conference bringing together the brightest minds in tech',
                    specialties: ['Technology', 'Innovation', 'AI']
                },
                {
                    id: '3',
                    name: 'Michael Chen',
                    member_type: 'Speaker',
                    location: 'Austin, TX',
                    bio: 'AI and machine learning expert helping businesses leverage cutting-edge technology',
                    specialties: ['AI', 'Machine Learning', 'Digital Transformation'],
                    average_rating: 4.9,
                    total_reviews: 38
                }
            ];
            
            allMembers = samples;
            updateStats(samples);
            displayMembers(samples);
        }

        function updateStats(members) {
            const speakers = members.filter(m => m.member_type === 'Speaker');
            const orgs = members.filter(m => m.member_type === 'Organization');
            
            const avgRating = speakers.length > 0 ? 
                (speakers.reduce((sum, s) => sum + (s.average_rating || 0), 0) / speakers.length).toFixed(1) : 
                '0.0';
            
            const thirtyDaysAgo = new Date();
            thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);
            const newMembers = members.filter(m => 
                m.created_at && new Date(m.created_at) > thirtyDaysAgo
            ).length;
            
            document.getElementById('totalSpeakers').textContent = speakers.length;
            document.getElementById('totalOrgs').textContent = orgs.length;
            document.getElementById('avgRating').textContent = avgRating;
            document.getElementById('newMembers').textContent = newMembers;
        }

        function displayMembers(members) {
            const grid = document.getElementById('membersGrid');
            
            if (members.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state" style="grid-column: 1 / -1;">
                        <div class="empty-state-icon">🔍</div>
                        <h3>No Members Found</h3>
                        <p>Try adjusting your search criteria</p>
                        <button class="btn btn-secondary mt-3" onclick="clearFilters()">
                            Clear Filters
                        </button>
                    </div>
                `;
                return;
            }
            
            if (currentView === 'grid') {
                displayGridView(members);
            } else {
                displayListView(members);
            }
        }

        function displayGridView(members) {
            const grid = document.getElementById('membersGrid');
            grid.className = 'members-grid'; // Reset class for grid view
            
            grid.innerHTML = members.map(member => {
                const initials = member.name ? 
                    member.name.split(' ').map(n => n[0]).join('').toUpperCase().slice(0, 2) : 
                    '??';
                
                const avatarContent = member.profile_image_url ? 
                    `<img src="${member.profile_image_url}" alt="${member.name}">` :
                    initials;
                
                const typeClass = member.member_type === 'Organization' ? 
                    'badge-organization' : 'badge-speaker';
                
                const specialties = member.specialties || [];
                
                let ratingHtml = '';
                if (member.member_type === 'Speaker' && member.average_rating) {
                    const stars = '★'.repeat(Math.floor(member.average_rating)) + 
                                '☆'.repeat(5 - Math.floor(member.average_rating));
                    ratingHtml = `
                        <div class="member-rating">
                            <span class="stars">${stars}</span>
                            <span class="rating-text">${member.average_rating.toFixed(1)} (${member.total_reviews || 0} reviews)</span>
                        </div>
                    `;
                }
                
                const statusIndicator = isAuthenticated ? 
                    '<span class="status-indicator"></span> Available' :
                    '<span class="status-indicator locked"></span> Login to contact';
                
                return `
                    <div class="member-card" onclick="viewProfile('${member.id}')">
                        <div class="member-header">
                            <div class="member-avatar">${avatarContent}</div>
                            <div class="member-basic-info">
                                <span class="member-type-badge ${typeClass}">
                                    ${member.member_type}
                                </span>
                                <h3 class="member-name">${member.name || 'Member'}</h3>
                                <div class="member-location">
                                    📍 ${member.location || 'Location not specified'}
                                </div>
                            </div>
                        </div>
                        <div class="member-body">
                            <p class="member-bio">
                                ${member.bio || 'No bio available'}
                            </p>
                            <div class="member-specialties">
                                ${specialties.slice(0, 3).map(s => 
                                    `<span class="specialty-tag">${s}</span>`
                                ).join('')}
                            </div>
                            ${ratingHtml}
                        </div>
                        <div class="member-footer">
                            <div class="contact-status">${statusIndicator}</div>
                            <button class="btn btn-primary btn-sm" onclick="event.stopPropagation(); viewProfile('${member.id}')">
                                View Profile
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function displayListView(members) {
            const grid = document.getElementById('membersGrid');
            grid.className = 'members-list'; // Change class for list view
            
            grid.innerHTML = `
                <div class="list-container">
                    <table class="members-table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Location</th>
                                <th>Specialties</th>
                                <th>Rating</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${members.map(member => {
                                const specialties = member.specialties || [];
                                const rating = member.average_rating || 0;
                                const typeClass = member.member_type === 'Organization' ? 
                                    'badge-organization' : 'badge-speaker';
                                
                                return `
                                    <tr onclick="viewProfile('${member.id}')" style="cursor: pointer;">
                                        <td>
                                            <strong>${member.name || 'Unknown'}</strong><br>
                                            <small>${member.email || ''}</small>
                                        </td>
                                        <td>
                                            <span class="member-type-badge ${typeClass}">
                                                ${member.member_type}
                                            </span>
                                        </td>
                                        <td>${member.location || '-'}</td>
                                        <td>${specialties.slice(0, 2).join(', ') || '-'}</td>
                                        <td>${rating > 0 ? `⭐ ${rating.toFixed(1)}` : '-'}</td>
                                        <td>
                                            <button onclick="event.stopPropagation(); viewProfile('${member.id}')" 
                                                    class="btn btn-primary btn-sm">
                                                View Profile
                                            </button>
                                        </td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function setView(view) {
            currentView = view;
            
            // Update toggle buttons
            document.querySelectorAll('.view-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Re-display members with new view
            performSearch(); // This will apply current filters and display in new view
        }

        function performSearch() {
            const searchTerm = document.getElementById('searchTerm').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            const locationFilter = document.getElementById('locationFilter').value.toLowerCase();
            const specialtyFilter = document.getElementById('specialtyFilter').value;
            
            let filtered = allMembers;
            
            if (typeFilter) {
                filtered = filtered.filter(m => m.member_type === typeFilter);
            }
            
            if (searchTerm) {
                filtered = filtered.filter(m => 
                    m.name?.toLowerCase().includes(searchTerm) ||
                    m.bio?.toLowerCase().includes(searchTerm)
                );
            }
            
            if (locationFilter) {
                filtered = filtered.filter(m => 
                    m.location?.toLowerCase().includes(locationFilter)
                );
            }
            
            if (specialtyFilter) {
                filtered = filtered.filter(m => 
                    m.specialties?.includes(specialtyFilter)
                );
            }
            
            displayMembers(filtered);
        }

        function clearFilters() {
            document.getElementById('searchTerm').value = '';
            document.getElementById('typeFilter').value = '';
            document.getElementById('locationFilter').value = '';
            document.getElementById('specialtyFilter').value = '';
            displayMembers(allMembers);
        }

        function viewProfile(memberId) {
            if (isAuthenticated) {
                window.location.href = `/profile.html?id=${memberId}`;
            } else {
                window.location.href = `/login.html?redirect=${encodeURIComponent(`/profile.html?id=${memberId}`)}`;
            }
        }

        // Initialize
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializePage);
        } else {
            initializePage();
        }
    </script>

    <!-- Service Worker Registration -->
    <script src="/js/sw-register.js"></script>

</body>
</html>